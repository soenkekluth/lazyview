!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.LazyLoadTask=e():t.LazyLoadTask=e()}(this,function(){return function(t){function e(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return t[o].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),l=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var s=r.get;if(void 0!==s)return s.call(o)},u=n(3),c=o(u),f=n(2),h=o(f),d=function(t){function e(t,n,o){return r(this,e),n=n||{},n.destroyOnComplete=!0,i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,"lazyload"))}return s(e,t),a(e,[{key:"getLazyItem",value:function(t){var e=t.getAttribute("data-src"),n=t.getAttribute("data-srcset"),o=!(!e&&!n);if(o){var r=!1;if(e&&t.getAttribute("src")!==e&&(r=!0),n&&t.getAttribute("srcset")!==n&&(r=!0),r)return t}return null}},{key:"init",value:function(){this.mediaToLoad=[],this.entered=!1;var t=this.lazyView.el;if(this.getLazyItem(t))this.mediaToLoad.push(t);else for(var n=t.querySelectorAll("img"),o=0,r=n.length;o<r;o++){var i=n[o];this.getLazyItem(i)&&this.mediaToLoad.push(i)}this.loadCount=this.mediaToLoad.length,this.loadCount?(l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.onLoad=this.onLoad.bind(this)):this.destroy()}},{key:"destroy",value:function(){l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this),this.onLoad=null}},{key:"onLoad",value:function(t){var e=t.target;--this.loadCount,e.removeEventListener("load",this.onLoad),e.removeEventListener("error",this.onLoad),this.options.loadClass&&e.classList.remove(this.options.loadClass),this.options.completeClass&&e.classList.add(this.options.completeClass),0===this.loadCount&&(this.options.onComplete&&this.options.onComplete.call(this,this.lazyView),this.lazyView.update(),this.options.destroyOnComplete&&this.destroy())}},{key:"onEnter",value:function(){if(!this.entered){this.entered=!0;for(var t=0,e=this.mediaToLoad.length;t<e;t++){var n=this.mediaToLoad[t],o=n.getAttribute("data-src"),r=n.getAttribute("data-srcset"),i=!1;o&&n.getAttribute("src")!==o&&(i=!0,n.setAttribute("src",o)),r&&n.getAttribute("srcset")!==r&&(i=!0,n.setAttribute("srcset",r)),i&&(n.addEventListener("load",this.onLoad),n.addEventListener("error",this.onLoad),this.options.loadClass&&n.classList.add(this.options.loadClass),n.removeAttribute("data-src"),n.removeAttribute("data-srcset"))}this.lazyView.removeOffset(this.name),this.options.onStart&&this.options.onStart.call(this,this.lazyView)}}}]),e}(h.default);t.exports=function(t){return new c.default(d,t)}},function(t,e){"use strict";function n(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function o(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;var o=Object.getOwnPropertyNames(e).map(function(t){return e[t]});if("0123456789"!==o.join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(t){r[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}var r=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;t.exports=o()?Object.assign:function(t,e){for(var o,s,a=n(t),l=1;l<arguments.length;l++){o=Object(arguments[l]);for(var u in o)r.call(o,u)&&(a[u]=o[u]);if(Object.getOwnPropertySymbols){s=Object.getOwnPropertySymbols(o);for(var c=0;c<s.length;c++)i.call(o,s[c])&&(a[s[c]]=o[s[c]])}}return a}},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),s=n(1),a=o(s),l=function(){function t(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"lazytask";r(this,t),this.lazyView=e,this.name=o,this.options=(0,a.default)({},t.defaults,n),this.onEnter=this.onEnter.bind(this),this.onExit=this.onExit.bind(this),this.init()}return i(t,[{key:"destroy",value:function(){this.lazyView.removeOffset(this.name),this.options=null,this.onEnter=null,this.onExit=null,this.lazyView=null}},{key:"init",value:function(){this.options.threshold?(this.lazyView.addOffset(this.name,this.options.threshold),this.lazyView.one("enter:"+this.name,this.onEnter),this.lazyView.one("exit:"+this.name,this.onExit)):(this.lazyView.one("enter",this.onEnter),this.lazyView.one("exit",this.onExit))}},{key:"onStart",value:function(t){return Promise.resolve(t)}},{key:"onComplete",value:function(t){return Promise.resolve(t)}},{key:"onEnter",value:function(){var t=this,e=this.options.onStart||this.onStart,n=this.options.onComplete||this.onComplete,o=e.call(this,this.lazyView);return o.then?o.then(function(e){return n.call(t,e||t.lazyView)}):n(o)}},{key:"onExit",value:function(){}}]),t}();l.defaults={destroyOnComplete:!1,completeClass:null,initClass:null,onStart:null,onComplete:null,onEnter:null,onExit:null},e.default=l,t.exports=e.default},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),s=(o(i),function t(e,n){r(this,t),this.creator=function(t){return new e(t,n)}});e.default=s,t.exports=e.default}])});